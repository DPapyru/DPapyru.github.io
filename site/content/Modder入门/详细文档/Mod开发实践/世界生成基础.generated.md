---
title: 世界生成基础 - 修改世界生成规则
description: 理解并修改世界生成，添加自定义内容
author: Papyru
category: Modder入门
topic: mod-dev
last_updated: 2026-01-30
prev_chapter: NPC弹幕联动
---

> WARNING: 版本说明：本教程适用于 **tModLoader 1.4.4+**

## 本章目标

学会修改世界生成，添加自定义物块、NPC 等。

## ModWorld 基础

创建继承 `ModWorld` 的类处理世界生成。

```csharp
public class MyModWorld : ModWorld {
    public override void PostWorldGen() {
        // 世界生成完成后执行
    }
}
```

## 添加自定义矿脉

在 `PostWorldGen` 中生成矿石：

```csharp
public override void PostWorldGen() {
    int oreType = ModContent.TileType<MyOre>();
    int count = (int)(Main.maxTilesX * Main.maxTilesY * 0.0006);
    
    for (int i = 0; i < count; i++) {
        int x = WorldGen.genRand.Next(0, Main.maxTilesX);
        int y = WorldGen.genRand.Next((int)GenVars.rockLayer, Main.maxTilesY - 100);
        
        WorldGen.OreRunner(x, y, WorldGen.genRand.Next(8, 15), WorldGen.genRand.Next(4, 8), oreType);
    }
}
```

## 在特定位置生成 NPC

```csharp
public override void PostWorldGen() {
    for (int i = 0; i < 5; i++) {
        int x = WorldGen.genRand.Next(100, Main.maxTilesX - 100);
        int y = (int)GenVars.worldSurface;
        
        NPC.NewNPC(null, x * 16, y * 16, ModContent.NPCType<MyNPC>());
    }
}
```

## 验证清单

- 创建了 ModWorld 类
- 重写了 PostWorldGen
- 生成后能看到自定义内容
- 没有崩溃或错误

## 注意事项

- 世界生成在服务器端执行
- 需要保存世界才能看到变化
- 修改生成规则需要重新生成世界

<!-- generated from: Modder入门/详细文档/Mod开发实践/世界生成基础.cs -->
