---
title: 制作第一把武器
author: 小天使
topic: modder-basic
description: 从基础开始了解C#和TML的API，以制作第一把武器
order: 1
difficulty: beginner
time: 15分钟
---
# 前言

如此美妙，我们进入了制作第一把武器的教程，我会根据需求在这边划分大体目录，有需要的可以通过大目录进行跳转

# C#知识

这边给那些没有学过C#一个快速的知识介绍，如果真需要学习C#，那请自行搜索教程

## C#语法

如同大部分C-Like （类似C语言的语法），C#的语法有一些需要注意的地方：

- 以 `{ }` 决定作用域，而不是缩进（缩进决定作用域是 Python 干的）
- 定义变量/常量，需要指定数据类型或者使用 `var` 隐式数据类型。
  - 写法举例：
  ```csharp
   int a = 0; // 定义一个变量，名字为a
   const int b = 4; // 定义一个常量，名字为b
   var c = 3.0f; // 隐式推断为float的变量，名字为c
   ```
  - 你不能干的举例：
   ```csharp
   a = 0; // Python语法
   val b : Int = 1; // koltin语法
   val c = 2; // JavaScprit语法
   // 当然还有在C#类的
   const var d = 2; // 你不能这样写！
   ```
- **方法（或者叫他们函数）** 写法如下：
```csharp
public void Func(int a,int b = 0)
{
   // 实际内容
}
// void Func() 是最简单的方法
// void 前能加很多关键字，这里不展开讲
```

> *心脏，给我瞄准心脏！*
> ***你学C#就不能瞄准C#的心脏吗！？***
> -- --
> **瓦伦西娜如此对卢西奥说。**

## C#基础语法代码（经典HelloWorld）:

```csharp
public class MainClass
{
    public static void Main(string[] args)
    {
        // 请输入文本
    }
}
```

# 制作第一把武器

在开始教学之前，我这边给出一个图表，明确说明目前阶段应该做什么（2*2田字图）：

| 水平 | 不会C# | 不知道tModLoader的API |
|:-:|:--:|:---:|
| 学习能力偏差 | 除了阅读上面的教程，请多学习C#这门语言的特性，不求很懂，但是需要基础语法 | 这边还推荐去看 [裙子的教程](https://fs49.org) |
| **自觉得** 学习能力偏强 | 同上，但是这个水平建议多学一点，了解一些东西不同的特性 | 同上，但是也可以只看本教程 |

那么现在就可以开始了。这边我得先说好：

> 以我的教学风格，我会让很多人深入学习
> ***但是，如果你读不懂，就不再是我考虑的事情***

## API介绍

> ***直到遇见了C#，我的人生便陷入了无边苦海，从未停歇***
> -- --
> Form:小指父辈 盐见夜

### 定义物品属性：`SetDefaults()`

{{cs:./code/firstclass_makefirstweapon.cs#cs:m:ModDocProject.ModsSource.Modder入门.FirstClass_MakeFirstWeapon.SetDefaults()}}

上面大部分全部用注释说明了，这边就详细讲一下: `Item.useAnimation`和`Item.useTime`

> 如果这个世界有悲剧，那RE所创造的这个东西就是最大的悲剧之一

- `Item.useAnimation`：物品使用动画的时间，设置这个影响使用的动画时间
- `Item.useTime`：物品使用速度的时间，设置这个影响物品使用的实际时间

这边看起来可能很抽象，但是确实如此，我举个例子：

***假如 `Item.useAnimation` 是 `Item.useTime` 的三倍，并且发射子弹，那么它在使用动画时间会发射三次子弹***

#### 题目：

```quiz
type: single
id: quiz-single-h7qyiq
question: |
  如果我把 `Item.damage` 调为 114514 会发生什么
options:
  - id: A
    text: 沼气爆炸
  - id: B
    text: 伤害变为114514
  - id: C
    text: 先怀疑能不能填114514
  - id: D
    text: 钝角
answer: B
explain: |
  这里当送分题，很明显正确答案只有B。
```

```quiz
type: tf
id: quiz-tf-h7xq9q
question: |
  我们还是继续说伤害的事情，你觉得伤害数字能填 *1145141919810* 吗？
answer: false
explain: |
  这不行，具体得需要看int的取值上限了，为21亿，这里超过了21亿。具体可以看 [菜鸟教程：C#数据类型](https://www.runoob.com/csharp/csharp-data-types.html)
```

```quiz
type: tf
id: quiz-tf-h7txgc
question: |
  假如 `Item.useAnimation` 是 `Item.useTime` 的2.5倍，发射子弹，那么会发射2发子弹
answer: true
explain: |
  这边如果做错不要气馁，这边就是专门为了告诉你：当 `Item.useAnimation` 是 `Item.useTime` 的非整数倍时间，通通向下取整为整数倍时间发射弹幕，具体得和RE说去。
```

### 合成表：`AddRecipes()`

{{cs:./code/firstclass_makefirstweapon.cs#cs:m:ModDocProject.ModsSource.Modder入门.FirstClass_MakeFirstWeapon.AddRecipes()}}

这边的代码逻辑说起来可能有一些复杂，如果我换成另一个写法你们就能看懂了

```csharp
// 通过这个重写方法添加合成表
public override void AddRecipes()
{
    Recipe recipe = CreateRecipe(); // 创建合成表
    recipe.AddIngredient(ItemID.GoldBar); // 添加合成物品
    recipe.AddTile(TileID.Anvils); // 添加需要在什么物块周边才能合成
    recipe.Register(); // 注册合成表
}
```

上面的写法主要和链式表达式有关，有兴趣的话可以看看文章结尾的介绍，没有兴趣的那就继续看下去。
