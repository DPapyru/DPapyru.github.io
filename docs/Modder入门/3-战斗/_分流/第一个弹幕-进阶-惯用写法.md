---
title: 第一个弹幕（进阶）：更贴近实战的写法
author: 小天使
date: 2026-01-20
last_updated: 2026-01-20
difficulty: intermediate
time: 8分钟
description: 当你已经有 C# 基础且熟悉 tML API 时，这里给出更贴近实战的组织方式与注意点
topic: mod-basics
order: 9403
hide: true
---

这份补充内容面向 **C≥1 且 T≥1**：默认你已能阅读本章代码，因此这里聚焦更惯用、可维护性更好的组织方式与注意点。

## 1）AI 状态管理

复杂的弹幕往往需要多个状态。可以使用 `Projectile.ai[]` 数组来存储状态：

```csharp
// 使用 ai[0] 作为计时器
Projectile.ai[0]++;
if (Projectile.ai[0] >= 30f)
{
    Projectile.ai[0] = 0;
    // 执行攻击逻辑
}
```

## 2）使用原版 AI 样式

如果你的弹幕行为接近原版，可以使用 `Projectile.aiStyle` 复用原版 AI：

```csharp
Projectile.aiStyle = 1;  // 使用原版子弹 AI
```

这样可以减少自定义 AI 的代码量。

## 3）性能优化

弹幕数量可能很多，要注意性能：
- 尽量减少每帧的计算量
- 使用碰撞检测优化（如只在靠近敌人时检查）
